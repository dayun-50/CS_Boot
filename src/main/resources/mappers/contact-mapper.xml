<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <!-- 연락처 -->
 <!-- 오류 방지 예시용 고쳐쓰시오. -->
 <mapper namespace="Contact">
 
	<!--  연락처 목록 조회  -->
    <select id="getMyContacts" resultType="com.kedu.project.contact.ContactDTO">
        SELECT 
            CONTACT_SEQ,
            OWNER_EMAIL,
            "NAME",
            EMAIL,
            PHONE,
            CONTACT_GROUP,
            COMPANY_CODE,
            MEMO,
            IS_SHARE AS "share"
        FROM contact
        ORDER BY CONTACT_SEQ DESC
    </select>

    <!-- 연락처 등록 -->
    <insert id="insertContact" parameterType="com.kedu.project.contact.ContactDTO">
        <selectKey keyProperty="contact_seq" resultType="int" order="BEFORE">
            SELECT contact_seq_seq.NEXTVAL FROM DUAL
        </selectKey>

        INSERT INTO contact (
            CONTACT_SEQ, "OWNER_EMAIL", "NAME", "EMAIL", "PHONE",
            CONTACT_GROUP, COMPANY_CODE, MEMO, IS_SHARE
        )
        VALUES (
            #{contact_seq}, #{owner_email}, #{name}, #{email}, #{phone},
            #{contact_group}, #{company_code}, #{memo}, #{share}
        )
    </insert>

    <!-- 연락처 수정 (share 포함) -->
    <update id="updateContact" parameterType="com.kedu.project.contact.ContactDTO">
        UPDATE contact
        SET
            "NAME" = #{name},
            EMAIL = #{email},
            PHONE = #{phone},
            CONTACT_GROUP = #{contact_group},
            COMPANY_CODE = #{company_code},
            MEMO = #{memo},
            IS_SHARE = #{share}
        WHERE CONTACT_SEQ = #{contact_seq}
    </update>

    <!-- 연락처 삭제 -->
    <delete id="deleteContact" parameterType="int">
        DELETE FROM contact WHERE contact_seq = #{contact_seq}
    </delete>
    
    <select id="contactList" resultType="com.kedu.project.contact.ContactDTO">
    	select * from contact where owner_email = #{email}
    </select>
    
    <select id="selectName" resultType="String">
    	select email from  where contact_seq = #{seq}
    </select>
  
  </mapper>